{"file":"elsa-context-menu.entry.cjs.js","mappings":"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","names":["ContextMenuAnchorPoint","map","h","TickIcon","enter","leave","toggle","groupBy"],"sources":["./src/components/shared/context-menu/context-menu.tsx"],"sourcesContent":["import {Component, h, Listen, Method, Prop, Element} from '@stencil/core';\r\nimport {leave, toggle, enter} from 'el-transition';\r\nimport {groupBy, map} from 'lodash';\r\nimport {ContextMenuAnchorPoint, ContextMenuItem} from \"./models\";\r\nimport {TickIcon} from \"../../icons/tooling/tick\";\r\n\r\n@Component({\r\n  tag: 'elsa-context-menu',\r\n  shadow: false,\r\n})\r\nexport class ContextMenu {\r\n  @Prop({mutable: true}) menuItems: Array<ContextMenuItem> = [];\r\n  @Prop() hideButton: boolean;\r\n  @Prop() anchorPoint: ContextMenuAnchorPoint;\r\n\r\n  contextMenu: HTMLElement;\r\n  @Element() element: HTMLElement;\r\n\r\n  @Method()\r\n  async open(): Promise<void> {\r\n    this.showContextMenu();\r\n  }\r\n\r\n  @Method()\r\n  async close(): Promise<void> {\r\n    this.closeContextMenu();\r\n  }\r\n\r\n  @Listen('click', {target: 'window'})\r\n  private onWindowClicked(event: Event) {\r\n    const target = event.target as HTMLElement;\r\n\r\n    if (!this.element.contains(target))\r\n      this.closeContextMenu();\r\n  }\r\n\r\n  private showContextMenu() {\r\n    if (!!this.contextMenu)\r\n      enter(this.contextMenu);\r\n  }\r\n\r\n  private closeContextMenu() {\r\n    if (!!this.contextMenu)\r\n      leave(this.contextMenu);\r\n  }\r\n\r\n  private toggleMenu() {\r\n    toggle(this.contextMenu);\r\n  }\r\n\r\n  private async onMenuItemClick(e: MouseEvent, menuItem: ContextMenuItem) {\r\n    e.preventDefault();\r\n\r\n    if (!!menuItem.handler)\r\n      menuItem.handler(e);\r\n\r\n    if (menuItem.isToggle) {\r\n      menuItem.checked = !menuItem.checked;\r\n      this.menuItems = [...this.menuItems]; // Trigger a re-render.\r\n    }\r\n\r\n    this.closeContextMenu();\r\n  }\r\n\r\n  private getAnchorPointClass = (): string => {\r\n    switch (this.anchorPoint) {\r\n      case ContextMenuAnchorPoint.BottomLeft:\r\n        return 'tw-origin-bottom-left tw-left-0';\r\n      case ContextMenuAnchorPoint.BottomRight:\r\n        return 'tw-origin-bottom-right tw-right-0';\r\n      case ContextMenuAnchorPoint.TopLeft:\r\n        return 'tw-origin-top-left tw-left-0';\r\n      case ContextMenuAnchorPoint.TopRight:\r\n      default:\r\n        return 'tw-origin-top-right tw-right-0'\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const anchorPointClass = this.getAnchorPointClass();\r\n    const menuItems = this.menuItems;\r\n    const menuItemGroups:any = groupBy(menuItems, x => x.group ?? 0);\r\n\r\n    return (\r\n      <div class=\"tw-relative tw-flex tw-justify-end tw-items-center\">\r\n        {this.renderButton()}\r\n        <div ref={el => this.contextMenu = el}\r\n             data-transition-enter=\"tw-transition tw-ease-out tw-duration-100\"\r\n             data-transition-enter-start=\"tw-transform tw-opacity-0 tw-scale-95\"\r\n             data-transition-leave=\"tw-transition tw-ease-in tw-duration-75\"\r\n             data-transition-leave-start=\"tw-transform tw-opacity-100 tw-scale-100\"\r\n             data-transition-leave-end=\"tw-transform tw-opacity-0 tw-scale-95\"\r\n             class={`hidden tw-z-10 tw-mx-3 tw-absolute ${anchorPointClass} tw-w-48 tw-mt-1 tw-rounded-md tw-shadow-lg`}>\r\n          <div class=\"tw-rounded-md tw-bg-white tw-shadow-xs tw-ring-1 tw-ring-black tw-ring-opacity-5 tw-divide-y tw-divide-gray-100 focus:tw-outline-none\" role=\"menu\" aria-orientation=\"vertical\" aria-labelledby=\"project-options-menu-0\">\r\n            {this.renderMenuItemGroups(menuItemGroups)}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderMenuItemGroups = (menuItemGroups: Array<any>) => {\r\n    if (Object.keys(menuItemGroups).length == 0)\r\n      return;\r\n\r\n    return map(menuItemGroups, group => this.renderMenuItems(group));\r\n  }\r\n\r\n  renderMenuItems = (menuItems: Array<ContextMenuItem>) => {\r\n    if (menuItems.length == 0)\r\n      return;\r\n\r\n    const hasAnyIcons = menuItems.find(x => !!x.icon) != null;\r\n\r\n    return <div class=\"tw-py-1\">\r\n      {menuItems.map(menuItem => {\r\n        const anchorUrl = menuItem.anchorUrl || '#';\r\n        const isToggle = menuItem.isToggle;\r\n        const checked = menuItem.checked;\r\n        return (\r\n\r\n          <a href={anchorUrl}\r\n             onClick={e => this.onMenuItemClick(e, menuItem)}\r\n             class=\"tw-group tw-flex tw-items-center tw-px-4 tw-py-2 tw-text-sm tw-leading-5 tw-text-gray-700 hover:tw-bg-gray-100 hover:tw-text-gray-900 focus:tw-outline-none focus:tw-bg-gray-100 focus:tw-text-gray-900\"\r\n             role=\"menuitem\">\r\n            {menuItem.icon ? <span class=\"tw-mr-3\">{menuItem.icon}</span> : hasAnyIcons ? <span class=\"tw-mr-7\"/> : undefined}\r\n            <span class=\"tw-flex-grow\">{menuItem.text}</span>\r\n            {isToggle && checked ? <span class=\"tw-float-right\"><TickIcon/></span> : undefined}\r\n          </a>\r\n        );\r\n      })}\r\n    </div>\r\n  };\r\n\r\n  renderButton = () => {\r\n    if (this.hideButton)\r\n      return;\r\n\r\n    return <button onClick={() => this.toggleMenu()} aria-has-popup=\"true\" type=\"button\"\r\n                   class=\"tw-w-8 tw-h-8 tw-inline-flex tw-items-center tw-justify-center tw-text-gray-400 tw-rounded-full tw-bg-transparent hover:tw-text-gray-500 focus:tw-outline-none focus:tw-text-gray-500 focus:tw-bg-gray-100 tw-transition tw-ease-in-out tw-duration-150\">\r\n      <svg class=\"tw-w-5 tw-h-5\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n        <path d=\"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z\"/>\r\n      </svg>\r\n    </button>;\r\n  }\r\n}\r\n"],"version":3}