{"version":3,"file":"login-page.js","sourceRoot":"","sources":["../../../../src/modules/login/components/login-page.tsx"],"names":[],"mappings":"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","sourcesContent":["import {Component, h, State, Event, EventEmitter} from \"@stencil/core\";\r\nimport {LoginApi} from \"../services\";\r\nimport {Container} from \"typedi\";\r\nimport {AuthContext} from \"../../../services\";\r\nimport {SignedInArgs} from \"../models\";\r\n\r\n@Component({\r\n  tag: 'elsa-login-page',\r\n  shadow: false\r\n})\r\nexport class LoginPage {\r\n\r\n  private loginApi: LoginApi;\r\n\r\n  @Event() signedIn: EventEmitter<SignedInArgs>;\r\n  @State() showError: boolean;\r\n\r\n  constructor() {\r\n    this.loginApi = Container.get(LoginApi);\r\n  }\r\n\r\n  private onSubmit = async (e: Event) => {\r\n    e.preventDefault();\r\n    this.showError = false;\r\n\r\n    window.requestAnimationFrame(() => {\r\n    });\r\n\r\n    const form: HTMLFormElement = e.target as HTMLFormElement;\r\n    const formData = new FormData(form);\r\n    const username = formData.get('username') as string;\r\n    const password = formData.get('password') as string;\r\n    const rememberMe = formData.get('remember-me') as string == 'true';\r\n    const loginResponse = await this.loginApi.login(username, password);\r\n\r\n    if (!loginResponse.isAuthenticated) {\r\n      this.showError = true;\r\n    }\r\n\r\n    this.signedIn.emit();\r\n\r\n    const accessToken = loginResponse.accessToken;\r\n    const refreshToken = loginResponse.refreshToken;\r\n    const authContext = Container.get(AuthContext);\r\n    await authContext.signin(accessToken, refreshToken, rememberMe);\r\n  }\r\n\r\n  private renderError = () => {\r\n    if (!this.showError)\r\n      return;\r\n\r\n    return <div class=\"tw-rounded-md tw-bg-red-50 tw-p-4\">\r\n      <div class=\"tw-flex\">\r\n        <div class=\"tw-flex-shrink-0\">\r\n          <svg class=\"tw-h-5 tw-w-5 tw-text-red-400\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\">\r\n            <path fill-rule=\"evenodd\"\r\n                  d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z\"\r\n                  clip-rule=\"evenodd\"/>\r\n          </svg>\r\n        </div>\r\n        <div class=\"tw-ml-3\">\r\n          <h3 class=\"tw-text-sm tw-font-medium tw-text-red-800\">Invalid credentials</h3>\r\n          <div class=\"tw-mt-2 tw-text-sm tw-text-red-700\">\r\n            The provided credentials were invalid. Please try again.\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  }\r\n\r\n  render() {\r\n    return <div>\r\n      <div class=\"tw-flex min-tw-h-full tw-flex-col tw-pt-20 tw-bg-gray-800 tw-h-screen\">\r\n\r\n        <div class=\"tw-mt-8 sm:tw-mx-auto sm:tw-w-full sm:tw-max-w-md\">\r\n          <div class=\"tw-bg-white tw-py-8 tw-px-4 tw-shadow sm:tw-rounded-lg sm:tw-px-10\">\r\n\r\n            {this.renderError()}\r\n\r\n            <form class=\"tw-mt-4 tw-space-y-6\" action=\"#\" method=\"POST\" onSubmit={this.onSubmit}>\r\n              <div>\r\n                <label htmlFor=\"username\" class=\"tw-block tw-text-sm tw-font-medium tw-text-gray-700\">Username</label>\r\n                <div class=\"tw-mt-1\">\r\n                  <input id=\"username\" name=\"username\" type=\"text\" autocomplete=\"off\" required\r\n                         class=\"tw-block tw-w-full tw-appearance-none tw-rounded-md tw-border tw-border-gray-300 tw-px-3 tw-py-2 tw-placeholder-gray-400 tw-shadow-sm focus:tw-border-blue-500 focus:tw-outline-none focus:tw-ring-blue-500 sm:tw-text-sm\"/>\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <label htmlFor=\"password\" class=\"tw-block tw-text-sm tw-font-medium tw-text-gray-700\">Password</label>\r\n                <div class=\"tw-mt-1\">\r\n                  <input id=\"password\" name=\"password\" type=\"password\" autoComplete=\"current-password\" required\r\n                         class=\"tw-block tw-w-full tw-appearance-none tw-rounded-md tw-border tw-border-gray-300 tw-px-3 tw-py-2 tw-placeholder-gray-400 tw-shadow-sm focus:tw-border-blue-500 focus:tw-outline-none focus:tw-ring-blue-500 sm:tw-text-sm\"/>\r\n                </div>\r\n              </div>\r\n\r\n              <div class=\"tw-flex tw-items-center tw-justify-between\">\r\n                <div class=\"tw-flex tw-items-center\">\r\n                  <input id=\"remember-me\" name=\"remember-me\" type=\"checkbox\" value=\"true\" class=\"tw-h-4 tw-w-4 tw-rounded tw-border-gray-300 tw-text-blue-600 focus:tw-ring-blue-500\"/>\r\n                  <label htmlFor=\"remember-me\" class=\"tw-ml-2 tw-block tw-text-sm tw-text-gray-900\">Remember me</label>\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <button type=\"submit\"\r\n                        class=\"tw-flex tw-w-full tw-justify-center tw-rounded-md tw-border tw-border-transparent tw-bg-blue-600 tw-py-2 tw-px-4 tw-text-sm tw-font-medium tw-text-white tw-shadow-sm hover:tw-bg-blue-700 focus:tw-outline-none focus:tw-ring-2 focus:tw-ring-blue-500 focus:tw-ring-offset-2\">Sign in\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>;\r\n  }\r\n}\r\n"]}