{"version":3,"file":"version-history.js","sourceRoot":"","sources":["../../../../../src/modules/workflow-definitions/components/workflow-properties/version-history.tsx"],"names":[],"mappings":"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","sourcesContent":["import {Component, Element, Event, EventEmitter, h, Prop, Watch} from '@stencil/core';\nimport {Container} from \"typedi\";\nimport {EventBus} from \"../../../../services\";\nimport {WorkflowDefinition} from \"../../models/entities\";\nimport {WorkflowDefinitionsApi} from \"../../services/api\";\nimport {DeleteIcon, RevertIcon, PublishedIcon} from \"../../../../components/icons/tooling\";\nimport moment from \"moment\";\nimport {ModalDialogService, DefaultModalActions, DefaultContents, ModalType} from \"../../../../components/shared/modal-dialog\";\nimport { getLocaleComponentStrings } from '../../../../utils/locale';\n\n@Component({\n  tag: 'elsa-workflow-definition-version-history',\n})\nexport class WorkflowDefinitionVersionHistory {\n  private readonly eventBus: EventBus;\n  private readonly workflowDefinitionApi: WorkflowDefinitionsApi;\n  private readonly modalDialogService: ModalDialogService;\n\n  constructor() {\n    this.eventBus = Container.get(EventBus);\n    this.workflowDefinitionApi = Container.get(WorkflowDefinitionsApi);\n    this.modalDialogService = Container.get(ModalDialogService);\n  }\n\n  @Prop() selectedVersion: WorkflowDefinition;\n  @Prop() workflowVersions: Array<WorkflowDefinition>;\n  @Prop() serverUrl: string;\n  @Event() versionSelected: EventEmitter<WorkflowDefinition>;\n  @Event() deleteVersionClicked: EventEmitter<WorkflowDefinition>;\n  @Event() revertVersionClicked: EventEmitter<WorkflowDefinition>;\n\n  @Element() element: HTMLElement;\n  strings!: any;\n\n  async componentWillLoad() {\n    this.strings = await getLocaleComponentStrings(this.element);\n  }\n\n\n  onViewVersionClick = (e: Event, version: WorkflowDefinition) => {\n    e.preventDefault();\n    this.versionSelected.emit(version);\n  };\n\n  onDeleteVersionClick = async (e: Event, version: WorkflowDefinition) => {\n    e.preventDefault();\n    this.modalDialogService.show(\n      () => DefaultContents.Warning(\"Are you sure you want to delete this version?\"),\n      {\n        modalType: ModalType.Confirmation,\n        actions: [DefaultModalActions.Delete(() => this.deleteVersionClicked.emit(version)), DefaultModalActions.Cancel()]\n      });\n  };\n\n  onRevertVersionClick = (e: Event, version: WorkflowDefinition) => {\n    e.preventDefault();\n    this.revertVersionClicked.emit(version);\n  };\n\n  render() {\n    return (\n      <div>\n        <table>\n          <thead>\n          <tr>\n            <th/>\n            <th>{this.strings.version}</th>\n            <th>{this.strings.created}</th>\n            <th/>\n            <th/>\n          </tr>\n          </thead>\n          <tbody>\n          {this.workflowVersions.map(v => {\n              let menuItems = [];\n              menuItems.push({text: this.strings.delete, handler: e => this.onDeleteVersionClick(e, v), icon: <DeleteIcon/>});\n\n              if (!v.isLatest)\n                menuItems.push({text: this.strings.revert, handler: e => this.onRevertVersionClick(e, v), icon: <RevertIcon/>});\n\n              return (\n                <tr>\n                  <td>{v.isPublished ? <PublishedIcon/> : \"\"}</td>\n                  <td>{v.version}</td>\n                  <td>{moment(v.createdAt).format('DD-MM-YYYY HH:mm:ss')}</td>\n                  <td>\n                    <button onClick={e => this.onViewVersionClick(e, v)}\n                            type=\"button\"\n                            disabled={this.selectedVersion.version == v.version}\n                            class={this.selectedVersion.version == v.version ? \"elsa-btn elsa-btn-primary\" : \"elsa-btn elsa-btn-secondary\"}>\n                      {this.strings.view}\n                    </button>\n                  </td>\n                  <td>\n                    {v.isPublished || v.isPublished ? undefined : <elsa-context-menu menuItems={menuItems}/>}\n                  </td>\n                </tr>\n              );\n            }\n          )}\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n}\n\n"]}