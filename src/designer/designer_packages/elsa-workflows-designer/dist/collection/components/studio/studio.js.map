{"version":3,"file":"studio.js","sourceRoot":"","sources":["../../../src/components/studio/studio.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAC,SAAS,EAAE,OAAO,EAAgB,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAC,MAAM,eAAe,CAAC;AAC5F,OAAO,kBAAkB,CAAC;AAC1B,OAAO,EAAC,SAAS,EAAC,MAAM,QAAQ,CAAC;AACjC,OAAO,EAAC,WAAW,EAAE,QAAQ,EAAE,cAAc,EAAE,cAAc,EAAC,MAAM,gBAAgB,CAAC;AACrF,OAAO,EAAC,oBAAoB,EAAC,MAAM,uCAAuC,CAAC;AAC3E,OAAO,EAAC,yBAAyB,EAAC,MAAM,qDAAqD,CAAC;AAC9F,OAAO,EAAC,UAAU,EAAC,MAAM,cAAc,CAAC;AACxC,OAAO,oBAAoB,MAAM,mCAAmC,CAAC;AACrE,OAAO,YAAY,MAAM,mCAAmC,CAAC;AAO7D,MAAM,OAAO,MAAM;EAKjB;;;;;IACE,IAAI,CAAC,QAAQ,GAAG,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IACxC,IAAI,CAAC,yBAAyB,GAAG,SAAS,CAAC,GAAG,CAAC,yBAAyB,CAAC,CAAC;IAC1E,IAAI,CAAC,cAAc,GAAG,SAAS,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;GACrD;EAUO,eAAe,CAAC,KAAa;IACnC,MAAM,QAAQ,GAAG,SAAS,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;IAC/C,QAAQ,CAAC,WAAW,GAAG,KAAK,CAAC;EAC/B,CAAC;EAGO,mBAAmB,CAAC,KAAa;IACvC,MAAM,QAAQ,GAAG,SAAS,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC;IACrD,QAAQ,CAAC,aAAa,GAAG,KAAK,CAAC;EACjC,CAAC;EAED,KAAK,CAAC,iBAAiB;IACrB,MAAM,cAAc,GAAG,SAAS,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;IACrD,MAAM,OAAO,GAA8B,EAAC,SAAS,EAAE,SAAS,EAAE,cAAc,EAAC,CAAC;IAClF,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAEhC,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;IAC7C,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IACrC,YAAY,CAAC,mBAAmB,GAAG,IAAI,CAAC,mBAAmB,CAAC;IAC5D,MAAM,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;IAC/D,MAAM,IAAI,CAAC,cAAc,CAAC,UAAU,EAAE,CAAC;IAEvC,2FAA2F;IAC3F,MAAM,WAAW,GAAG,SAAS,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IAE/C,IAAI,IAAI,CAAC,WAAW,IAAI,WAAW,CAAC,aAAa,EAAE,EAAE;MACnD,MAAM,QAAQ,GAAG,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;MACzC,MAAM,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;KAC9C;EACH,CAAC;EAED,MAAM;IACJ,OAAO,EAAC,IAAI;MACV,gCAAwB;MACxB,WAAK,KAAK,EAAC,qBAAqB,IAC7B,oBAAoB,CAAC,sBAAsB,EAAE,CAC1C;MACL,oBAAoB,CAAC,eAAe,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,EAAE,CAAC;MAC3D,sCAA8B,CACzB,CAAC;EACV,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CACF","sourcesContent":["import {Component, Element, EventEmitter, h, Host, Prop, Watch, Event} from '@stencil/core';\nimport 'reflect-metadata';\nimport {Container} from 'typedi';\nimport {AuthContext, EventBus, PluginRegistry, ServerSettings} from '../../services';\nimport {MonacoEditorSettings} from \"../../services/monaco-editor-settings\";\nimport {WorkflowDefinitionManager} from \"../../modules/workflow-definitions/services/manager\";\nimport {EventTypes} from \"../../models\";\nimport studioComponentStore from \"../../data/studio-component-store\";\nimport optionsStore from '../../data/designer-options-store';\nimport {StudioInitializingContext} from \"../../models/studio\";\n\n@Component({\n  tag: 'elsa-studio',\n  styleUrl: 'studio.css',\n})\nexport class Studio {\n  private readonly eventBus: EventBus;\n  private readonly workflowDefinitionManager: WorkflowDefinitionManager;\n  private readonly pluginRegistry: PluginRegistry;\n\n  constructor() {\n    this.eventBus = Container.get(EventBus);\n    this.workflowDefinitionManager = Container.get(WorkflowDefinitionManager);\n    this.pluginRegistry = Container.get(PluginRegistry);\n  }\n\n  @Element() private el: HTMLElsaStudioElement;\n  @Prop({attribute: 'server'}) serverUrl: string;\n  @Prop({attribute: 'monaco-lib-path'}) monacoLibPath: string;\n  @Prop({attribute: 'enable-flexible-ports'}) enableFlexiblePorts: boolean;\n  @Prop({attribute: 'disable-auth'}) disableAuth: boolean;\n  @Event() initializing: EventEmitter<StudioInitializingContext>;\n\n  @Watch('serverUrl')\n  private handleServerUrl(value: string) {\n    const settings = Container.get(ServerSettings);\n    settings.baseAddress = value;\n  }\n\n  @Watch('monacoLibPath')\n  private handleMonacoLibPath(value: string) {\n    const settings = Container.get(MonacoEditorSettings);\n    settings.monacoLibPath = value;\n  }\n\n  async componentWillLoad() {\n    const pluginRegistry = Container.get(PluginRegistry);\n    const context: StudioInitializingContext = {container: Container, pluginRegistry};\n    this.initializing.emit(context);\n\n    this.handleMonacoLibPath(this.monacoLibPath);\n    this.handleServerUrl(this.serverUrl);\n    optionsStore.enableFlexiblePorts = this.enableFlexiblePorts;\n    await this.eventBus.emit(EventTypes.Studio.Initializing, this);\n    await this.pluginRegistry.initialize();\n\n    // If we have a valid session, emit the signed in event so that descriptors will be loaded.\n    const authContext = Container.get(AuthContext);\n\n    if (this.disableAuth || authContext.getIsSignedIn()) {\n      const eventBus = Container.get(EventBus);\n      await eventBus.emit(EventTypes.Auth.SignedIn)\n    }\n  }\n\n  render() {\n    return <Host>\n      <elsa-workflow-toolbar/>\n      <div class=\"elsa-studio-content\">\n        {studioComponentStore.activeComponentFactory()}\n      </div>\n      {studioComponentStore.modalComponents.map(modal => modal())}\n      <elsa-modal-dialog-container/>\n    </Host>;\n  }\n}\n"]}