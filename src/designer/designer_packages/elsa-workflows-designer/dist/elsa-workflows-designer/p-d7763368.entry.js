import{h as t,r as e,c as i,a as s}from"./p-a7a3baa1.js";import{l as n}from"./p-e71312f9.js";import{s as a}from"./p-b6964c5d.js";import{F as l,C as o}from"./p-b15e4c38.js";import{o as h,u as r,C as c,ac as u,a4 as d,aa as p,a3 as m,ab as w,B as b,Y as v}from"./p-691e5295.js";import"./p-219f806a.js";import{g as y}from"./p-e754efd8.js";import{E as f,D as g}from"./p-2e503831.js";import{h as x}from"./p-ddecd487.js";import"./p-72dc819a.js";import"./p-144a434e.js";import"./p-ec4413cd.js";const k=()=>t("svg",{class:"tw-h-6 tw-w-6 tw-text-gray-500",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},t("path",{stroke:"none",d:"M0 0h24v24H0z"}),t("path",{d:"M9 11l-4 4l4 4m-4 -4h11a4 4 0 0 0 0 -8h-1"}));const I=()=>t("svg",{class:"tw-h-6 tw-w-6 tw-text-blue-500",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"}));const N=class{constructor(t){e(this,t);this.inputChanged=i(this,"inputChanged",7);this.onSubmit=async t=>{t.preventDefault();const e=t.target;const i=this.getInputInternal(e);this.inputChanged.emit(i)};this.getInputInternal=t=>{const e=new FormData(t);const i=e.get("inputName");const s=e.get("inputDisplayName");const n=e.get("inputTypeName");const a=e.get("inputDescription");const l=e.get("inputCategory");const o=e.get("inputUIHint");const r=e.get("inputIsArray")==="true";const c=e.get("inputStorageDriverType");const u=this.input;u.name=i;u.type=n;u.displayName=s;u.category=l;u.description=a;u.uiHint=o;u.isArray=r;u.storageDriverType=h(c)?null:c;return u};this.input=undefined}async getInput(){return this.getInputInternal(this.formElement)}async componentWillLoad(){this.strings=await y(this.element);console.log(this.strings)}render(){var e;const i=(e=this.input)!==null&&e!==void 0?e:{name:"",type:"Object",isArray:false};const s=i.type;const h=a.variableDescriptors;const r=a.storageDrivers;const c=n.groupBy(h,(t=>t.category));const u=i.uiHint;const d=[{name:"Single line",value:"single-line"},{name:"Multi line",value:"multi-line"},{name:"Checkbox",value:"checkbox"},{name:"Check list",value:"check-list"},{name:"Radio list",value:"radio-list"},{name:"Dropdown",value:"dropdown"},{name:"Multi text",value:"multi-text"},{name:"Code editor",value:"code-editor"},{name:"Variable picker",value:"variable-picker"},{name:"Type picker",value:"type-picker"}];return t("div",null,t("form",{ref:t=>this.formElement=t,class:"tw-h-full tw-flex tw-flex-col tw-bg-white",onSubmit:t=>this.onSubmit(t),method:"post"},t("div",{class:"tw-pt-4"},t("h2",{class:"tw-text-lg tw-font-medium tw-ml-4 tw-mb-2"}," ",this.strings.editInputConfiguration),t("div",{class:"tw-align-middle tw-inline-block tw-min-w-full tw-border-b tw-border-gray-200"},t(l,{fieldId:"inputName",label:this.strings.inputName,hint:this.strings.inputNameHint},t("input",{type:"text",name:"inputName",id:"inputName",value:i.name})),t(l,{fieldId:"inputTypeName",label:this.strings.inputType,hint:this.strings.inputTypeHint},t("select",{id:"inputTypeName",name:"inputTypeName"},Object.keys(c).map((e=>{const i=c[e];return t("optgroup",{label:e},i.map((e=>t("option",{value:e.typeName,selected:e.typeName==s},e.displayName))))})))),t(o,{fieldId:"inputIsArray",label:this.strings.arrayInputLabel,hint:this.strings.arrayInputHint},t("input",{type:"checkbox",name:"inputIsArray",id:"inputIsArray",value:"true",checked:i.isArray})),t(l,{fieldId:"inputDisplayName",label:this.strings.displayNameLabel,hint:this.strings.displayNameHint},t("input",{type:"text",name:"inputDisplayName",id:"inputDisplayName",value:i.displayName})),t(l,{fieldId:"inputDescription",label:this.strings.inputDescriptionLabel,hint:this.strings.inputDescriptionHint},t("input",{type:"text",name:"inputDescription",id:"inputDescription",value:i.description})),t(l,{fieldId:"inputCategory",label:this.strings.inputCategoryLabel,hint:this.strings.inputCategoryHint},t("input",{type:"text",name:"inputCategory",id:"inputCategory",value:i.category})),t(l,{fieldId:"inputUIHint",label:this.strings.controlLabel,hint:this.strings.controlHint},t("select",{name:"inputUIHint",id:"inputUIHint"},d.map((e=>{const i=e.value==u;return t("option",{value:e.value,selected:i},e.name)})))),t(l,{fieldId:"inputStorageDriverType",label:this.strings.storageLabel,hint:this.strings.storageHint},t("select",{id:"inputStorageDriverType",name:"inputStorageDriverType"},r.map((e=>{const s=e.typeName;const n=e.displayName;const a=s==i.storageDriverType;return t("option",{value:s,selected:a},n)}))))))))}get element(){return s(this)}};const C=class{constructor(t){e(this,t);this.outputChanged=i(this,"outputChanged",7);this.onSubmit=async t=>{t.preventDefault();const e=t.target;const i=this.getOutputInternal(e);this.outputChanged.emit(i)};this.getOutputInternal=t=>{const e=new FormData(t);const i=e.get("outputName");const s=e.get("outputDisplayName");const n=e.get("outputTypeName");const a=e.get("outputDescription");const l=this.output;l.name=i;l.type=n;l.displayName=s;l.description=a;return l};this.output=undefined}async getOutput(){return this.getOutputInternal(this.formElement)}async componentWillLoad(){this.strings=await y(this.element)}render(){var e;const i=(e=this.output)!==null&&e!==void 0?e:{name:"",type:"Object",isArray:false};const s=i.type;const o=a.variableDescriptors;const h=n.groupBy(o,(t=>t.category));return t("div",null,t("form",{ref:t=>this.formElement=t,class:"tw-h-full tw-flex tw-flex-col tw-bg-white",onSubmit:t=>this.onSubmit(t),method:"post"},t("div",{class:"tw-pt-4"},t("h2",{class:"tw-text-lg tw-font-medium tw-ml-4 tw-mb-2"},this.strings.editOutputDefinition),t("div",{class:"tw-align-middle tw-inline-block tw-min-w-full tw-border-b tw-border-gray-200"},t(l,{fieldId:"outputName",label:this.strings.outputName,hint:this.strings.outputNameHint},t("input",{type:"text",name:"outputName",id:"outputName",value:i.name})),t(l,{fieldId:"outputTypeName",label:this.strings.outputType,hint:this.strings.outputTypeHint},t("select",{id:"outputTypeName",name:"outputTypeName"},Object.keys(h).map((e=>{const i=h[e];return t("optgroup",{label:e},i.map((e=>t("option",{value:e.typeName,selected:e.typeName==s},e.displayName))))})))),t(l,{fieldId:"outputDisplayName",label:this.strings.outputDisplayName,hint:this.strings.outputDisplayNameHint},t("input",{type:"text",name:"outputDisplayName",id:"outputDisplayName",value:i.displayName})),t(l,{fieldId:"outputDescription",label:this.strings.outputDescription,hint:this.strings.outputDescriptionHint},t("input",{type:"text",name:"outputDescription",id:"outputDescription",value:i.description}))))))}get element(){return s(this)}};const D=class{constructor(t){e(this,t);this.variableChanged=i(this,"variableChanged",7);this.onSubmit=async t=>{t.preventDefault();const e=t.target;const i=this.getVariableInternal(e);this.variableChanged.emit(i)};this.getVariableInternal=t=>{const e=new FormData(t);const i=e.get("variableName");const s=e.get("variableValue");const n=e.get("variableTypeName");const a=e.get("variableIsArray")=="true";const l=e.get("variableStorageDriverTypeName");const o=this.variable;if(h(o.id))o.id=r();o.name=i;o.typeName=n;o.value=s;o.isArray=a;o.storageDriverTypeName=h(l)?null:l;return o};this.variable=undefined}async getVariable(){return this.getVariableInternal(this.formElement)}async componentWillLoad(){this.strings=await y(this.element);console.log(this.strings)}render(){var e;const i=(e=this.variable)!==null&&e!==void 0?e:{id:"",name:"",typeName:"Object",isArray:false};const s=i.typeName;const h=a.variableDescriptors;const r=n.groupBy(h,(t=>t.category));const c=a.storageDrivers;return t("div",null,t("form",{ref:t=>this.formElement=t,class:"tw-h-full tw-flex tw-flex-col tw-bg-white",onSubmit:t=>this.onSubmit(t),method:"post"},t("div",{class:"tw-pt-4"},t("h2",{class:"tw-text-lg tw-font-medium tw-ml-4 tw-mb-2"},this.strings.editVariable),t("div",{class:"tw-align-middle tw-inline-block tw-min-w-full tw-border-b tw-border-gray-200"},t(l,{fieldId:"variableName",label:this.strings.labelName,hint:this.strings.nameHint},t("input",{type:"text",name:"variableName",id:"variableName",value:i.name})),t(l,{fieldId:"variableTypeName",label:this.strings.labelType,hint:this.strings.typeHint},t("select",{id:"variableTypeName",name:"variableTypeName"},Object.keys(r).map((e=>{const i=r[e];return t("optgroup",{label:e},i.map((e=>t("option",{value:e.typeName,selected:e.typeName==s},e.displayName))))})))),t(o,{fieldId:"variableIsArray",label:this.strings.labelArray,hint:this.strings.arrayHint},t("input",{type:"checkbox",name:"variableIsArray",id:"variableIsArray",value:"true",checked:i.isArray})),t(l,{fieldId:"variableValue",label:this.strings.labelValue,hint:this.strings.valueHint},t("input",{type:"text",name:"variableValue",id:"variableValue",value:i.value})),t(l,{fieldId:"variableStorageDriverId",label:this.strings.labelStorage,hint:this.strings.storageHint},t("select",{id:"variableStorageDriverTypeName",name:"variableStorageDriverTypeName"},c.map((e=>{const s=e.typeName;const n=e.displayName;const a=s==i.storageDriverTypeName;return t("option",{value:s,selected:a},n)}))))))))}get element(){return s(this)}};const j=class{constructor(s){e(this,s);this.variablesChanged=i(this,"variablesChanged",7);this.getVariableNameExists=t=>!!this.variables.find((e=>e.name==t));this.updateVariablesState=t=>{this.variablesState=t;this.variablesChanged.emit(t)};this.generateNewVariableName=()=>{const t=this.variables;let e=t.length;while(true){const t=`Variable${++e}`;if(!this.getVariableNameExists(t))return t}};this.onAddVariableClick=async()=>{const e=this.generateNewVariableName();const i={id:"",name:e,typeName:"Object",value:null,isArray:false};this.modalDialogInstance=this.modalDialogService.show((()=>t("elsa-variable-editor-dialog-content",{variable:i})),{actions:[this.saveAction]})};this.onEditClick=async(e,i)=>{e.preventDefault();this.modalDialogInstance=this.modalDialogService.show((()=>t("elsa-variable-editor-dialog-content",{variable:i})),{actions:[this.saveAction]})};this.onDeleteClick=(t,e)=>{t.preventDefault();const i=this.variables.filter((t=>t!=e));this.updateVariablesState(i)};this.onVariableChanged=async t=>{const e=await t.instance.modalDialogContentRef.getVariable();let i=this.variables;const s=!!i.find((t=>t==e));if(s)i=[...i];else i=[...i,e];i=i.sort(((t,e)=>t.name<e.name?-1:t.name>e.name?1:0));this.updateVariablesState(i)};this.variables=undefined;this.variablesState=[];this.modalDialogService=c.get(u);this.saveAction={name:"Save",type:d.Submit,text:"Save",isPrimary:true,onClick:this.onVariableChanged}}onVariablesPropChanged(t){this.variablesState=!!this.variables?[...this.variables]:[]}async componentWillLoad(){this.strings=await y(this.element);this.onVariablesPropChanged(this.variables)}render(){const e=this.variables;const i=a.storageDrivers;return t("div",null,t("div",{class:"tw-flex tw-justify-end tw-m-4"},t("button",{class:"elsa-btn elsa-btn-primary",onClick:t=>this.onAddVariableClick()},"Add variable")),t("div",{class:"tw-align-middle tw-inline-block tw-min-w-full tw-border-b tw-border-gray-200"},t("table",{class:"default-table"},t("thead",null,t("tr",null,t("th",{scope:"col"},this.strings.columName),t("th",{scope:"col"},this.strings.columnType),t("th",{scope:"col"},this.strings.columStorage),t("th",{scope:"col"}))),t("tbody",null,e.map((e=>{var s,n;const l=i.find((t=>t.typeName==e.storageDriverTypeName));const o=(s=l===null||l===void 0?void 0:l.displayName)!==null&&s!==void 0?s:"-";const h=a.variableDescriptors.find((t=>t.typeName==e.typeName));const r=(n=h===null||h===void 0?void 0:h.displayName)!==null&&n!==void 0?n:e.typeName;return t("tr",null,t("td",{class:"tw-whitespace-nowrap"},e.name),t("td",{class:"tw-whitespace-nowrap"},r),t("td",null,o),t("td",{class:"tw-pr-6"},t("elsa-context-menu",{menuItems:[{text:this.strings.variableEditButton,handler:t=>this.onEditClick(t,e),icon:t(f,null)},{text:this.strings.variableDeleteButton,handler:t=>this.onDeleteClick(t,e),icon:t(g,null)}]})))}))))))}get element(){return s(this)}static get watchers(){return{variables:["onVariablesPropChanged"]}}};const _=class{constructor(t){e(this,t);this.widgets=[]}render(){const e=this.widgets.sort(((t,e)=>t.order<e.order?-1:t.order>e.order?1:0));return t("div",null,e.map((t=>t.content())))}};const T=class{constructor(s){e(this,s);this.inputsChanged=i(this,"inputsChanged",7);this.outputsChanged=i(this,"outputsChanged",7);this.outcomesChanged=i(this,"outcomesChanged",7);this.renderInputs=()=>{const e=this.inputsState;return t("div",null,t("div",{class:"tw-p-4"},t("h3",{class:"tw-text-base tw-leading-6 tw-font-medium tw-text-gray-900"},this.strings.inputsLabel)),t("div",{class:"tw-align-middle tw-inline-block tw-min-w-full tw-border-b tw-border-gray-200"},t("table",{class:"default-table"},t("thead",null,t("tr",null,t("th",{scope:"col"},this.strings.inputName),t("th",{scope:"col"},this.strings.inputType),t("th",{scope:"col"}))),t("tbody",null,e.map((e=>{var i;const s=a.variableDescriptors.find((t=>t.typeName==e.type));const n=(i=s===null||s===void 0?void 0:s.displayName)!==null&&i!==void 0?i:e.type;return t("tr",null,t("td",{class:"tw-whitespace-nowrap"},e.name),t("td",{class:"tw-whitespace-nowrap"},n),t("td",{class:"tw-pr-6"},t("elsa-context-menu",{menuItems:[{text:this.strings.editButton,handler:t=>this.onEditInputClick(t,e),icon:t(f,null)},{text:this.strings.deleteButton,handler:t=>this.onDeleteInputClick(t,e),icon:t(g,null)}]})))}))))),t("div",{class:"tw-flex tw-justify-end tw-m-4"},t("button",{class:"elsa-btn elsa-btn-primary",onClick:t=>this.onAddInputClick()},this.strings.addInputButton)))};this.renderOutputs=()=>{const e=this.outputsState;return t("div",null,t("div",{class:"tw-p-4"},t("h3",{class:"tw-text-base tw-leading-6 tw-font-medium tw-text-gray-900"},this.strings.outputLabel)),t("div",{class:"tw-align-middle tw-inline-block tw-min-w-full tw-border-b tw-border-gray-200"},t("table",{class:"default-table"},t("thead",null,t("tr",null,t("th",{scope:"col"},this.strings.outputName),t("th",{scope:"col"},this.strings.outputType),t("th",{scope:"col"}))),t("tbody",null,e.map((e=>{var i;const s=a.variableDescriptors.find((t=>t.typeName==e.type));const n=(i=s===null||s===void 0?void 0:s.displayName)!==null&&i!==void 0?i:e.type;return t("tr",null,t("td",{class:"tw-whitespace-nowrap"},e.name),t("td",{class:"tw-whitespace-nowrap"},n),t("td",{class:"tw-pr-6"},t("elsa-context-menu",{menuItems:[{text:this.strings.editButton,handler:t=>this.onEditOutputClick(t,e),icon:t(f,null)},{text:this.strings.deleteButton,handler:t=>this.onDeleteOutputClick(t,e),icon:t(g,null)}]})))}))))),t("div",{class:"tw-flex tw-justify-end tw-m-4"},t("button",{class:"elsa-btn elsa-btn-primary",onClick:t=>this.onAddOutputClick()},this.strings.addOutputButton)))};this.renderOutcomes=()=>{const e=[...this.outcomes];return t("div",null,t("div",{class:"tw-p-4"},t("h3",{class:"tw-text-base tw-leading-6 tw-font-medium tw-text-gray-900"},this.strings.labelOutcome)),t(l,{label:"",fieldId:"WorkflowDefinitionOutcomes",hint:this.strings.outcomeHint},t("elsa-input-tags",{placeHolder:this.strings.placeholderOutcome,values:e,onValueChanged:t=>this.onOutcomesChanged(t.detail)})))};this.getInputNameExists=t=>!!this.inputsState.find((e=>e.name==t));this.getOutputNameExists=t=>!!this.outputsState.find((e=>e.name==t));this.updateInputsState=t=>{this.inputsState=t;this.inputsChanged.emit(t)};this.updateOutputsState=t=>{this.outputsState=t;this.outputsChanged.emit(t)};this.generateNewInputName=()=>{const t=this.inputsState;let e=t.length;while(true){const t=`Input${++e}`;if(!this.getInputNameExists(t))return t}};this.generateNewOutputName=()=>{const t=this.outputsState;let e=t.length;while(true){const t=`Output${++e}`;if(!this.getOutputNameExists(t))return t}};this.onAddInputClick=async()=>{const e=this.generateNewInputName();const i={name:e,type:"Object",displayName:e,isArray:false};this.modalDialogInstance=this.modalDialogService.show((()=>t("elsa-activity-input-editor-dialog-content",{input:i})),{actions:[this.inputSaveAction]})};this.onAddOutputClick=async()=>{const e=this.generateNewOutputName();const i={name:e,type:"Object",displayName:e,isArray:false};this.modalDialogInstance=this.modalDialogService.show((()=>t("elsa-activity-output-editor-dialog-content",{output:i})),{actions:[this.outputSaveAction]})};this.onEditInputClick=async(e,i)=>{e.preventDefault();this.modalDialogInstance=this.modalDialogService.show((()=>t("elsa-activity-input-editor-dialog-content",{input:i})),{actions:[this.inputSaveAction]})};this.onEditOutputClick=async(e,i)=>{e.preventDefault();this.modalDialogInstance=this.modalDialogService.show((()=>t("elsa-activity-output-editor-dialog-content",{output:i})),{actions:[this.outputSaveAction]})};this.onDeleteInputClick=(t,e)=>{t.preventDefault();const i=this.inputsState.filter((t=>t!=e));this.updateInputsState(i)};this.onDeleteOutputClick=(t,e)=>{t.preventDefault();const i=this.outputsState.filter((t=>t!=e));this.updateOutputsState(i)};this.onInputDefinitionChanged=async t=>{const e=await t.instance.modalDialogContentRef.getInput();let i=this.inputsState;const s=!!i.find((t=>t==e));if(s)i=[...i];else i=[...i,e];i=i.sort(((t,e)=>t.name<e.name?-1:t.name>e.name?1:0));this.updateInputsState(i)};this.onOutputDefinitionChanged=async t=>{const e=await t.instance.modalDialogContentRef.getOutput();let i=this.outputsState;const s=!!i.find((t=>t==e));if(s)i=[...i];else i=[...i,e];i=i.sort(((t,e)=>t.name<e.name?-1:t.name>e.name?1:0));this.updateOutputsState(i)};this.onOutcomesChanged=t=>{this.outcomesChanged.emit(t)};this.inputs=undefined;this.outputs=undefined;this.outcomes=undefined;this.inputsState=[];this.outputsState=[];this.modalDialogService=c.get(u);this.inputSaveAction={name:"Save",type:d.Submit,text:"Save",isPrimary:true,onClick:this.onInputDefinitionChanged};this.outputSaveAction={name:"Save",type:d.Submit,text:"Save",isPrimary:true,onClick:this.onOutputDefinitionChanged}}onInputsPropChanged(t){this.inputsState=!!this.inputs?[...this.inputs]:[]}onOutputsPropChanged(t){this.outputsState=!!this.outputs?[...this.outputs]:[]}async componentWillLoad(){this.strings=await y(this.element);this.onInputsPropChanged(this.inputs);this.onOutputsPropChanged(this.outputs)}render(){return t("div",null,this.renderInputs(),this.renderOutputs(),this.renderOutcomes())}get element(){return s(this)}static get watchers(){return{inputs:["onInputsPropChanged"],outputs:["onOutputsPropChanged"]}}};const S=class{constructor(t){e(this,t);this.versionSelected=i(this,"versionSelected",7);this.deleteVersionClicked=i(this,"deleteVersionClicked",7);this.revertVersionClicked=i(this,"revertVersionClicked",7);this.onViewVersionClick=(t,e)=>{t.preventDefault();this.versionSelected.emit(e)};this.onDeleteVersionClick=async(t,e)=>{t.preventDefault();this.modalDialogService.show((()=>p.Warning("Are you sure you want to delete this version?")),{modalType:m.Confirmation,actions:[w.Delete((()=>this.deleteVersionClicked.emit(e))),w.Cancel()]})};this.onRevertVersionClick=(t,e)=>{t.preventDefault();this.revertVersionClicked.emit(e)};this.selectedVersion=undefined;this.workflowVersions=undefined;this.serverUrl=undefined;this.eventBus=c.get(b);this.workflowDefinitionApi=c.get(v);this.modalDialogService=c.get(u)}async componentWillLoad(){this.strings=await y(this.element)}render(){return t("div",null,t("table",null,t("thead",null,t("tr",null,t("th",null),t("th",null,this.strings.version),t("th",null,this.strings.created),t("th",null),t("th",null))),t("tbody",null,this.workflowVersions.map((e=>{let i=[];i.push({text:this.strings.delete,handler:t=>this.onDeleteVersionClick(t,e),icon:t(g,null)});if(!e.isLatest)i.push({text:this.strings.revert,handler:t=>this.onRevertVersionClick(t,e),icon:t(k,null)});return t("tr",null,t("td",null,e.isPublished?t(I,null):""),t("td",null,e.version),t("td",null,x(e.createdAt).format("DD-MM-YYYY HH:mm:ss")),t("td",null,t("button",{onClick:t=>this.onViewVersionClick(t,e),type:"button",disabled:this.selectedVersion.version==e.version,class:this.selectedVersion.version==e.version?"elsa-btn elsa-btn-primary":"elsa-btn elsa-btn-secondary"},this.strings.view)),t("td",null,e.isPublished||e.isPublished?undefined:t("elsa-context-menu",{menuItems:i})))})))))}get element(){return s(this)}};export{N as elsa_activity_input_editor_dialog_content,C as elsa_activity_output_editor_dialog_content,D as elsa_variable_editor_dialog_content,j as elsa_variables_editor,_ as elsa_widgets,T as elsa_workflow_definition_input_output_settings,S as elsa_workflow_definition_version_history};
//# sourceMappingURL=p-d7763368.entry.js.map