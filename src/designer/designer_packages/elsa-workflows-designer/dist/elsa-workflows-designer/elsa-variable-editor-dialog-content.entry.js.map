{"file":"elsa-variable-editor-dialog-content.entry.esm.js","mappings":";;;;;;;;;;;;;;;;;MAYa,2BAA2B;;;;IAkE9B,aAAQ,GAAG,OAAO,CAAQ;MAChC,CAAC,CAAC,cAAc,EAAE,CAAC;MACnB,MAAM,IAAI,GAAG,CAAC,CAAC,MAAyB,CAAC;MACzC,MAAM,QAAQ,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;MAChD,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;KACrC,CAAC;IAEM,wBAAmB,GAAG,CAAC,IAAqB;MAClD,MAAM,QAAQ,GAAG,IAAI,QAAQ,CAAC,IAAuB,CAAC,CAAC;MACvD,MAAM,IAAI,GAAG,QAAQ,CAAC,GAAG,CAAC,cAAc,CAAW,CAAC;MACpD,MAAM,KAAK,GAAG,QAAQ,CAAC,GAAG,CAAC,eAAe,CAAW,CAAC;MACtD,MAAM,IAAI,GAAG,QAAQ,CAAC,GAAG,CAAC,kBAAkB,CAAW,CAAC;MACxD,MAAM,OAAO,GAAG,QAAQ,CAAC,GAAG,CAAC,iBAAiB,CAAW,IAAI,MAAM,CAAC;MACpE,MAAM,cAAc,GAAG,QAAQ,CAAC,GAAG,CAAC,+BAA+B,CAAW,CAAC;MAC/E,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;MAE/B,IAAI,kBAAkB,CAAC,QAAQ,CAAC,EAAE,CAAC;QACjC,QAAQ,CAAC,EAAE,GAAG,gBAAgB,EAAE,CAAC;MAEnC,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC;MACrB,QAAQ,CAAC,QAAQ,GAAG,IAAI,CAAC;MACzB,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC;MACvB,QAAQ,CAAC,OAAO,GAAG,OAAO,CAAC;MAC3B,QAAQ,CAAC,qBAAqB,GAAG,kBAAkB,CAAC,cAAc,CAAC,GAAG,IAAI,GAAG,cAAc,CAAC;MAE5F,OAAO,QAAQ,CAAC;KACjB,CAAC;;;EArFF,MAAM,WAAW;IACf,OAAO,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;GACnD;EAED,MAAM;;IACJ,MAAM,QAAQ,GAAa,MAAA,IAAI,CAAC,QAAQ,mCAAI,EAAC,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,QAAQ,EAAE,QAAQ,EAAE,OAAO,EAAE,KAAK,EAAC,CAAC;IACnG,MAAM,gBAAgB,GAAG,QAAQ,CAAC,QAAQ,CAAC;IAC3C,MAAM,cAAc,GAA8BA,KAAgB,CAAC,mBAAmB,CAAC;IACvF,MAAM,oBAAoB,GAAGC,cAAO,CAAC,cAAc,EAAE,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,CAAC;IACtE,MAAM,cAAc,GAAmCD,KAAgB,CAAC,cAAc,CAAC;IAEvF,QACE,eACE,YAAM,GAAG,EAAE,EAAE,IAAI,IAAI,CAAC,WAAW,GAAG,EAAE,EAAE,KAAK,EAAC,2CAA2C,EAAC,QAAQ,EAAE,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,MAAM,EAAC,MAAM,IACtI,WAAK,KAAK,EAAC,SAAS,IAClB,UAAI,KAAK,EAAC,2CAA2C,oBAAmB,EACxE,WAAK,KAAK,EAAC,8EAA8E,IAEvF,EAAC,SAAS,IAAC,OAAO,EAAC,cAAc,EAAC,KAAK,EAAC,MAAM,EAAC,IAAI,EAAC,qCAAqC,IACvF,aAAO,IAAI,EAAC,MAAM,EAAC,IAAI,EAAC,cAAc,EAAC,EAAE,EAAC,cAAc,EAAC,KAAK,EAAE,QAAQ,CAAC,IAAI,GAAG,CACtE,EAEZ,EAAC,SAAS,IAAC,OAAO,EAAC,kBAAkB,EAAC,KAAK,EAAC,MAAM,EAAC,IAAI,EAAC,2BAA2B,IACjF,cAAQ,EAAE,EAAC,kBAAkB,EAAC,IAAI,EAAC,kBAAkB,IAClD,MAAM,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC,GAAG,CAAC,QAAQ;MAC7C,MAAM,aAAa,GAAG,oBAAoB,CAAC,QAAQ,CAA8B,CAAC;MAClF,QAAQ,gBAAU,KAAK,EAAE,QAAQ,IAC9B,aAAa,CAAC,GAAG,CAAC,UAAU,IAAI,cAAQ,KAAK,EAAE,UAAU,CAAC,QAAQ,EAAE,QAAQ,EAAE,UAAU,CAAC,QAAQ,IAAI,gBAAgB,IAAG,UAAU,CAAC,WAAW,CAAU,CAAC,CACjJ,EAAE;KACd,CAAC,CACK,CACC,EAEZ,EAAC,iBAAiB,IAAC,OAAO,EAAC,iBAAiB,EAAC,KAAK,EAAC,2BAA2B,EAAC,IAAI,EAAC,4DAA4D,IAC9I,aAAO,IAAI,EAAC,UAAU,EAAC,IAAI,EAAC,iBAAiB,EAAC,EAAE,EAAC,iBAAiB,EAAC,KAAK,EAAC,MAAM,EAAC,OAAO,EAAE,QAAQ,CAAC,OAAO,GAAG,CAC1F,EAEpB,EAAC,SAAS,IAAC,OAAO,EAAC,eAAe,EAAC,KAAK,EAAC,OAAO,EAAC,IAAI,EAAC,4BAA4B,IAChF,aAAO,IAAI,EAAC,MAAM,EAAC,IAAI,EAAC,eAAe,EAAC,EAAE,EAAC,eAAe,EAAC,KAAK,EAAE,QAAQ,CAAC,KAAK,GAAG,CACzE,EAEZ,EAAC,SAAS,IAAC,OAAO,EAAC,yBAAyB,EAAC,KAAK,EAAC,SAAS,EAAC,IAAI,EAAC,kDAAkD,IAClH,cAAQ,EAAE,EAAC,+BAA+B,EAAC,IAAI,EAAC,+BAA+B,IAC5E,cAAc,CAAC,GAAG,CAAC,MAAM;MACxB,MAAM,KAAK,GAAG,MAAM,CAAC,QAAQ,CAAC;MAC9B,MAAM,IAAI,GAAG,MAAM,CAAC,WAAW,CAAC;MAChC,MAAM,QAAQ,GAAG,KAAK,IAAI,QAAQ,CAAC,qBAAqB,CAAC;MACzD,OAAO,cAAQ,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,IAAG,IAAI,CAAU,CAAC;KAClE,CAAC,CACK,CACC,CAER,CACF,CACD,CACH,EACN;GACH;;;;;","names":["descriptorsStore","groupBy"],"sources":["./src/modules/workflow-definitions/components/workflow-properties/variable-editor-dialog-content.tsx"],"sourcesContent":["import {Component, h, Prop, Event, EventEmitter, Method} from \"@stencil/core\";\r\nimport {groupBy} from 'lodash';\r\nimport {StorageDriverDescriptor, Variable} from \"../../../../models\";\r\nimport {generateIdentity, isNullOrWhitespace} from \"../../../../utils\";\r\nimport descriptorsStore from '../../../../data/descriptors-store';\r\nimport {VariableDescriptor} from \"../../../../services/api-client/variable-descriptors-api\";\r\nimport {CheckboxFormEntry, FormEntry} from \"../../../../components/shared/forms/form-entry\";\r\n\r\n@Component({\r\n  tag: 'elsa-variable-editor-dialog-content',\r\n  shadow: false\r\n})\r\nexport class VariableEditorDialogContent {\r\n  private formElement: HTMLFormElement;\r\n\r\n  @Prop() variable: Variable;\r\n  @Event() variableChanged: EventEmitter<Variable>;\r\n\r\n  @Method()\r\n  async getVariable(): Promise<Variable> {\r\n    return this.getVariableInternal(this.formElement);\r\n  }\r\n\r\n  render() {\r\n    const variable: Variable = this.variable ?? {id: '', name: '', typeName: 'Object', isArray: false};\r\n    const variableTypeName = variable.typeName;\r\n    const availableTypes: Array<VariableDescriptor> = descriptorsStore.variableDescriptors;\r\n    const groupedVariableTypes = groupBy(availableTypes, x => x.category);\r\n    const storageDrivers: Array<StorageDriverDescriptor> = descriptorsStore.storageDrivers;\r\n\r\n    return (\r\n      <div>\r\n        <form ref={el => this.formElement = el} class=\"tw-h-full tw-flex tw-flex-col tw-bg-white\" onSubmit={e => this.onSubmit(e)} method=\"post\">\r\n          <div class=\"tw-pt-4\">\r\n            <h2 class=\"tw-text-lg tw-font-medium tw-ml-4 tw-mb-2\">Edit Variable</h2>\r\n            <div class=\"tw-align-middle tw-inline-block tw-min-w-full tw-border-b tw-border-gray-200\">\r\n\r\n              <FormEntry fieldId=\"variableName\" label=\"Name\" hint=\"The technical name of the variable.\">\r\n                <input type=\"text\" name=\"variableName\" id=\"variableName\" value={variable.name}/>\r\n              </FormEntry>\r\n\r\n              <FormEntry fieldId=\"variableTypeName\" label=\"Type\" hint=\"The type of the variable.\">\r\n                <select id=\"variableTypeName\" name=\"variableTypeName\">\r\n                  {Object.keys(groupedVariableTypes).map(category => {\r\n                    const variableTypes = groupedVariableTypes[category] as Array<VariableDescriptor>;\r\n                    return (<optgroup label={category}>\r\n                      {variableTypes.map(descriptor => <option value={descriptor.typeName} selected={descriptor.typeName == variableTypeName}>{descriptor.displayName}</option>)}\r\n                    </optgroup>);\r\n                  })}\r\n                </select>\r\n              </FormEntry>\r\n\r\n              <CheckboxFormEntry fieldId=\"variableIsArray\" label=\"This variable is an array\" hint=\"Check if the variable holds an array of the selected type.\">\r\n                <input type=\"checkbox\" name=\"variableIsArray\" id=\"variableIsArray\" value=\"true\" checked={variable.isArray}/>\r\n              </CheckboxFormEntry>\r\n\r\n              <FormEntry fieldId=\"variableValue\" label=\"Value\" hint=\"The value of the variable.\">\r\n                <input type=\"text\" name=\"variableValue\" id=\"variableValue\" value={variable.value}/>\r\n              </FormEntry>\r\n\r\n              <FormEntry fieldId=\"variableStorageDriverId\" label=\"Storage\" hint=\"The storage to use when persisting the variable.\">\r\n                <select id=\"variableStorageDriverTypeName\" name=\"variableStorageDriverTypeName\">\r\n                  {storageDrivers.map(driver => {\r\n                    const value = driver.typeName;\r\n                    const text = driver.displayName;\r\n                    const selected = value == variable.storageDriverTypeName;\r\n                    return <option value={value} selected={selected}>{text}</option>;\r\n                  })}\r\n                </select>\r\n              </FormEntry>\r\n\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private onSubmit = async (e: Event) => {\r\n    e.preventDefault();\r\n    const form = e.target as HTMLFormElement;\r\n    const variable = this.getVariableInternal(form);\r\n    this.variableChanged.emit(variable);\r\n  };\r\n\r\n  private getVariableInternal = (form: HTMLFormElement): Variable => {\r\n    const formData = new FormData(form as HTMLFormElement);\r\n    const name = formData.get('variableName') as string;\r\n    const value = formData.get('variableValue') as string;\r\n    const type = formData.get('variableTypeName') as string;\r\n    const isArray = formData.get('variableIsArray') as string == 'true';\r\n    const driverTypeName = formData.get('variableStorageDriverTypeName') as string;\r\n    const variable = this.variable;\r\n\r\n    if (isNullOrWhitespace(variable.id))\r\n      variable.id = generateIdentity();\r\n\r\n    variable.name = name;\r\n    variable.typeName = type;\r\n    variable.value = value;\r\n    variable.isArray = isArray;\r\n    variable.storageDriverTypeName = isNullOrWhitespace(driverTypeName) ? null : driverTypeName;\r\n\r\n    return variable;\r\n  };\r\n\r\n}\r\n"],"version":3}