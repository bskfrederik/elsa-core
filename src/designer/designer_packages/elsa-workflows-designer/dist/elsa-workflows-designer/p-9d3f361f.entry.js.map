{"version":3,"names":["WorkflowDefinitionActivityVersionSettings","this","onUpdateClick","activity","renderContext","version","latestAvailablePublishedVersion","workflowDefinitionVersionId","latestAvailablePublishedVersionId","currentVersion","notifyActivityChanged","onRenderContextChanged","value","_a","componentWillLoad","render","h","activityId","id","upgradeAvailable","key","versionDetails","toString","InfoList","title","dictionary","class","onClick","e"],"sources":["./src/modules/workflow-definitions/components/activity-properties/activity-version-settings.tsx"],"sourcesContent":["import {h, Component, Prop, State, Watch} from \"@stencil/core\";\r\nimport {RenderActivityPropsContext, WorkflowDefinitionActivity} from \"../models\";\r\nimport {isNullOrWhitespace} from \"../../../../utils\";\r\nimport {InfoList} from \"../../../../components/shared/forms/info-list\";\r\n\r\n@Component({\r\n  tag: 'elsa-workflow-definition-activity-version-settings',\r\n  shadow: false\r\n})\r\nexport class WorkflowDefinitionActivityVersionSettings {\r\n\r\n  @Prop() renderContext: RenderActivityPropsContext;\r\n\r\n  @State() private currentVersion: number;\r\n\r\n  @Watch('renderContext')\r\n  onRenderContextChanged(value: RenderActivityPropsContext) {\r\n    const activity = value?.activity as WorkflowDefinitionActivity;\r\n    this.currentVersion = activity?.version ?? 0;\r\n  }\r\n\r\n  componentWillLoad() {\r\n    this.onRenderContextChanged(this.renderContext);\r\n  }\r\n\r\n  render() {\r\n\r\n    if (!this.renderContext)\r\n      return <div/>;\r\n\r\n    const activity = this.renderContext.activity as WorkflowDefinitionActivity;\r\n    const activityId = activity.id;\r\n    const latestAvailablePublishedVersion = activity.latestAvailablePublishedVersion;\r\n    const upgradeAvailable = activity.version < latestAvailablePublishedVersion;\r\n    const key = `${activityId}`;\r\n\r\n    const versionDetails = {\r\n      'Current version': this.currentVersion.toString(),\r\n      'Published version': latestAvailablePublishedVersion?.toString() ?? '-',\r\n    };\r\n\r\n    return <div key={key}>\r\n      <InfoList title=\"Version\" dictionary={versionDetails}/>\r\n      {upgradeAvailable &&\r\n        <div>\r\n          <button class=\"elsa-btn elsa-btn-default\" onClick={e => this.onUpdateClick()}>Upgrade</button>\r\n        </div>}\r\n    </div>\r\n  }\r\n\r\n  private onUpdateClick = () => {\r\n    const activity = this.renderContext.activity as WorkflowDefinitionActivity;\r\n    activity.version = activity.latestAvailablePublishedVersion;\r\n    activity.workflowDefinitionVersionId = activity.latestAvailablePublishedVersionId;\r\n    this.currentVersion = activity.version;\r\n    this.renderContext.notifyActivityChanged();\r\n  };\r\n}\r\n"],"mappings":"6PASaA,EAAyC,M,yBAyC5CC,KAAAC,cAAgB,KACtB,MAAMC,EAAWF,KAAKG,cAAcD,SACpCA,EAASE,QAAUF,EAASG,gCAC5BH,EAASI,4BAA8BJ,EAASK,kCAChDP,KAAKQ,eAAiBN,EAASE,QAC/BJ,KAAKG,cAAcM,uBAAuB,E,2DAvC5CC,uBAAuBC,G,MACrB,MAAMT,EAAWS,IAAK,MAALA,SAAK,SAALA,EAAOT,SACxBF,KAAKQ,gBAAiBI,EAAAV,IAAQ,MAARA,SAAQ,SAARA,EAAUE,WAAO,MAAAQ,SAAA,EAAAA,EAAI,C,CAG7CC,oBACEb,KAAKU,uBAAuBV,KAAKG,c,CAGnCW,S,MAEE,IAAKd,KAAKG,cACR,OAAOY,EAAA,YAET,MAAMb,EAAWF,KAAKG,cAAcD,SACpC,MAAMc,EAAad,EAASe,GAC5B,MAAMZ,EAAkCH,EAASG,gCACjD,MAAMa,EAAmBhB,EAASE,QAAUC,EAC5C,MAAMc,EAAM,GAAGH,IAEf,MAAMI,EAAiB,CACrB,kBAAmBpB,KAAKQ,eAAea,WACvC,qBAAqBT,EAAAP,IAA+B,MAA/BA,SAA+B,SAA/BA,EAAiCgB,cAAU,MAAAT,SAAA,EAAAA,EAAI,KAGtE,OAAOG,EAAA,OAAKI,IAAKA,GACfJ,EAACO,EAAQ,CAACC,MAAM,UAAUC,WAAYJ,IACrCF,GACCH,EAAA,WACEA,EAAA,UAAQU,MAAM,4BAA4BC,QAASC,GAAK3B,KAAKC,iBAAe,Y"}