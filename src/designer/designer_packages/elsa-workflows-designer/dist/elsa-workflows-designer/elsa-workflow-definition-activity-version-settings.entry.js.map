{"file":"elsa-workflow-definition-activity-version-settings.entry.esm.js","mappings":";;;;;;;;;;;;;;;;MASa,yCAAyC;;;IAyC5C,kBAAa,GAAG;MACtB,MAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,QAAsC,CAAC;MAC3E,QAAQ,CAAC,OAAO,GAAG,QAAQ,CAAC,+BAA+B,CAAC;MAC5D,QAAQ,CAAC,2BAA2B,GAAG,QAAQ,CAAC,iCAAiC,CAAC;MAClF,IAAI,CAAC,cAAc,GAAG,QAAQ,CAAC,OAAO,CAAC;MACvC,IAAI,CAAC,aAAa,CAAC,qBAAqB,EAAE,CAAC;KAC5C,CAAC;;;;EAxCF,sBAAsB,CAAC,KAAiC;;IACtD,MAAM,QAAQ,GAAG,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,QAAsC,CAAC;IAC/D,IAAI,CAAC,cAAc,GAAG,MAAA,QAAQ,aAAR,QAAQ,uBAAR,QAAQ,CAAE,OAAO,mCAAI,CAAC,CAAC;GAC9C;EAED,iBAAiB;IACf,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;GACjD;EAED,MAAM;;IAEJ,IAAI,CAAC,IAAI,CAAC,aAAa;MACrB,OAAO,cAAM,CAAC;IAEhB,MAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,QAAsC,CAAC;IAC3E,MAAM,UAAU,GAAG,QAAQ,CAAC,EAAE,CAAC;IAC/B,MAAM,+BAA+B,GAAG,QAAQ,CAAC,+BAA+B,CAAC;IACjF,MAAM,gBAAgB,GAAG,QAAQ,CAAC,OAAO,GAAG,+BAA+B,CAAC;IAC5E,MAAM,GAAG,GAAG,GAAG,UAAU,EAAE,CAAC;IAE5B,MAAM,cAAc,GAAG;MACrB,iBAAiB,EAAE,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE;MACjD,mBAAmB,EAAE,MAAA,+BAA+B,aAA/B,+BAA+B,uBAA/B,+BAA+B,CAAE,QAAQ,EAAE,mCAAI,GAAG;KACxE,CAAC;IAEF,OAAO,WAAK,GAAG,EAAE,GAAG,IAClB,EAAC,QAAQ,IAAC,KAAK,EAAC,SAAS,EAAC,UAAU,EAAE,cAAc,GAAG,EACtD,gBAAgB;MACf,eACE,cAAQ,KAAK,EAAC,2BAA2B,EAAC,OAAO,EAAE,CAAC,IAAI,IAAI,CAAC,aAAa,EAAE,cAAkB,CAC1F,CACJ,CAAA;GACP;;;;;;;;","names":[],"sources":["./src/modules/workflow-definitions/components/activity-properties/activity-version-settings.tsx"],"sourcesContent":["import {h, Component, Prop, State, Watch} from \"@stencil/core\";\r\nimport {RenderActivityPropsContext, WorkflowDefinitionActivity} from \"../models\";\r\nimport {isNullOrWhitespace} from \"../../../../utils\";\r\nimport {InfoList} from \"../../../../components/shared/forms/info-list\";\r\n\r\n@Component({\r\n  tag: 'elsa-workflow-definition-activity-version-settings',\r\n  shadow: false\r\n})\r\nexport class WorkflowDefinitionActivityVersionSettings {\r\n\r\n  @Prop() renderContext: RenderActivityPropsContext;\r\n\r\n  @State() private currentVersion: number;\r\n\r\n  @Watch('renderContext')\r\n  onRenderContextChanged(value: RenderActivityPropsContext) {\r\n    const activity = value?.activity as WorkflowDefinitionActivity;\r\n    this.currentVersion = activity?.version ?? 0;\r\n  }\r\n\r\n  componentWillLoad() {\r\n    this.onRenderContextChanged(this.renderContext);\r\n  }\r\n\r\n  render() {\r\n\r\n    if (!this.renderContext)\r\n      return <div/>;\r\n\r\n    const activity = this.renderContext.activity as WorkflowDefinitionActivity;\r\n    const activityId = activity.id;\r\n    const latestAvailablePublishedVersion = activity.latestAvailablePublishedVersion;\r\n    const upgradeAvailable = activity.version < latestAvailablePublishedVersion;\r\n    const key = `${activityId}`;\r\n\r\n    const versionDetails = {\r\n      'Current version': this.currentVersion.toString(),\r\n      'Published version': latestAvailablePublishedVersion?.toString() ?? '-',\r\n    };\r\n\r\n    return <div key={key}>\r\n      <InfoList title=\"Version\" dictionary={versionDetails}/>\r\n      {upgradeAvailable &&\r\n        <div>\r\n          <button class=\"elsa-btn elsa-btn-default\" onClick={e => this.onUpdateClick()}>Upgrade</button>\r\n        </div>}\r\n    </div>\r\n  }\r\n\r\n  private onUpdateClick = () => {\r\n    const activity = this.renderContext.activity as WorkflowDefinitionActivity;\r\n    activity.version = activity.latestAvailablePublishedVersion;\r\n    activity.workflowDefinitionVersionId = activity.latestAvailablePublishedVersionId;\r\n    this.currentVersion = activity.version;\r\n    this.renderContext.notifyActivityChanged();\r\n  };\r\n}\r\n"],"version":3}