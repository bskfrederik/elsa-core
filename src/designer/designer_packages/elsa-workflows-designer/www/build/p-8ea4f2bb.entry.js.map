{"version":3,"names":["VariablePickerInput","this","workflowDefinitions","onChange","e","inputElement","target","definitionId","value","inputContext","inputChanged","SyntaxNames","Literal","async","apiClient","Container","get","WorkflowDefinitionsApi","response","list","versionOptions","isPublished","orderBy","WorkflowDefinitionsOrderBy","Name","items","render","inputDescriptor","fieldName","name","fieldId","displayName","description","getPropertyValue","currentValue","_a","expression","h","FormEntry","label","hint","id","map","definition","isSelected","selected"],"sources":["./src/modules/workflow-definitions/components/inputs/workflow-definition-picker.tsx"],"sourcesContent":["import {Component, h, Prop} from '@stencil/core';\r\nimport {Container} from \"typedi\";\r\nimport {WorkflowDefinitionSummary} from \"../../models/entities\";\r\nimport {ActivityInputContext} from \"../../../../services/activity-input-driver\";\r\nimport {getPropertyValue} from \"../../../../utils\";\r\nimport {ActivityInput, Expression, SyntaxNames} from \"../../../../models\";\r\nimport {FormEntry} from \"../../../../components/shared/forms/form-entry\";\r\nimport {WorkflowDefinitionsApi, WorkflowDefinitionsOrderBy} from \"../../services/api\";\r\n\r\n@Component({\r\n  tag: 'elsa-workflow-definition-picker-input',\r\n  shadow: false\r\n})\r\nexport class VariablePickerInput {\r\n  @Prop() inputContext: ActivityInputContext;\r\n  private workflowDefinitions: Array<WorkflowDefinitionSummary> = [];\r\n\r\n  async componentWillLoad() {\r\n    const apiClient = Container.get(WorkflowDefinitionsApi);\r\n    const response = await apiClient.list({versionOptions: {isPublished: true}, orderBy: WorkflowDefinitionsOrderBy.Name});\r\n    this.workflowDefinitions = response.items;\r\n  }\r\n\r\n  public render() {\r\n    const inputContext = this.inputContext;\r\n    const inputDescriptor = inputContext.inputDescriptor;\r\n    const fieldName = inputDescriptor.name;\r\n    const fieldId = inputDescriptor.name;\r\n    const displayName = inputDescriptor.displayName;\r\n    const description = inputDescriptor.description;\r\n    const workflowDefinitions = this.workflowDefinitions;\r\n    const value = getPropertyValue(inputContext) as ActivityInput;\r\n    const currentValue = value?.expression?.value;\r\n\r\n    return (\r\n      <FormEntry fieldId={fieldId} label={displayName} hint={description}>\r\n        <select id={fieldId} name={fieldName} onChange={e => this.onChange(e)}>\r\n          {workflowDefinitions.map((definition: WorkflowDefinitionSummary) => {\r\n            const definitionId = definition.definitionId;\r\n            const isSelected = definitionId == currentValue;\r\n            return <option value={definitionId} selected={isSelected}>{definition.name}</option>;\r\n          })}\r\n        </select>\r\n      </FormEntry>\r\n    );\r\n  }\r\n\r\n  private onChange = (e: Event) => {\r\n    const inputElement = e.target as HTMLSelectElement;\r\n    const definitionId = inputElement.value;\r\n    this.inputContext.inputChanged(definitionId, SyntaxNames.Literal);\r\n  }\r\n}\r\n"],"mappings":"6TAaaA,EAAmB,M,yBAEtBC,KAAAC,oBAAwD,GAgCxDD,KAAAE,SAAYC,IAClB,MAAMC,EAAeD,EAAEE,OACvB,MAAMC,EAAeF,EAAaG,MAClCP,KAAKQ,aAAaC,aAAaH,EAAcI,EAAYC,QAAQ,E,4BAjCnEC,0BACE,MAAMC,EAAYC,EAAUC,IAAIC,GAChC,MAAMC,QAAiBJ,EAAUK,KAAK,CAACC,eAAgB,CAACC,YAAa,MAAOC,QAASC,EAA2BC,OAChHvB,KAAKC,oBAAsBgB,EAASO,K,CAG/BC,S,MACL,MAAMjB,EAAeR,KAAKQ,aAC1B,MAAMkB,EAAkBlB,EAAakB,gBACrC,MAAMC,EAAYD,EAAgBE,KAClC,MAAMC,EAAUH,EAAgBE,KAChC,MAAME,EAAcJ,EAAgBI,YACpC,MAAMC,EAAcL,EAAgBK,YACpC,MAAM9B,EAAsBD,KAAKC,oBACjC,MAAMM,EAAQyB,EAAiBxB,GAC/B,MAAMyB,GAAeC,EAAA3B,IAAK,MAALA,SAAK,SAALA,EAAO4B,cAAU,MAAAD,SAAA,SAAAA,EAAE3B,MAExC,OACE6B,EAACC,EAAS,CAACR,QAASA,EAASS,MAAOR,EAAaS,KAAMR,GACrDK,EAAA,UAAQI,GAAIX,EAASD,KAAMD,EAAWzB,SAAUC,GAAKH,KAAKE,SAASC,IAChEF,EAAoBwC,KAAKC,IACxB,MAAMpC,EAAeoC,EAAWpC,aAChC,MAAMqC,EAAarC,GAAgB2B,EACnC,OAAOG,EAAA,UAAQ7B,MAAOD,EAAcsC,SAAUD,GAAaD,EAAWd,KAAc,K"}