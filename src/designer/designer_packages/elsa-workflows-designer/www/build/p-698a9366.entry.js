import{r as t,c as s,h as e}from"./p-a7a3baa1.js";import{C as i,x as o,J as r,Q as l,o as n,N as d}from"./p-691e5295.js";import"./p-219f806a.js";import{s as w}from"./p-b6964c5d.js";import{F as c}from"./p-01ef35ed.js";import"./p-144a434e.js";import"./p-72dc819a.js";import"./p-e71312f9.js";import"./p-ddecd487.js";import"./p-37e9f5c1.js";const a=class{constructor(l){t(this,l);this.editChildActivity=s(this,"editChildActivity",7);this.childActivitySelected=s(this,"childActivitySelected",7);this.portElements=[];this.renderIcon=t=>{const s=this.displayTypeIsPicker?"tw-px-2":"tw-px-4";if(!t)return undefined;return e("div",{class:`${s} tw-py-1`},t())};this.renderPorts=(t,s)=>{if(this.displayTypeIsPicker||!this.activityDescriptor)return;if(s.length==0)return;return e("div",{class:"activity-ports tw-mt-2 tw-flex tw-space-x-2"},s.map((s=>this.renderPort(t,s))))};this.renderPort=(t,s)=>{const i=(t===null||t===void 0?void 0:t.canStartWorkflow)==true;const o=i?"tw-text-white":"tw-text-gray-600";const r=s.name==this.selectedPortName?"tw-border-blue-600":"tw-border-gray-300";const l=this.activityDescriptor;const n=this.portProviderRegistry.get(l.typeName);const d=n.resolvePort(s.name,{activity:t,activityDescriptor:l});const w=()=>{if(!d){return e("div",{class:"tw-relative tw-block tw-w-full tw-border-2 tw-border-gray-300 tw-border-dashed tw-rounded-lg tw-p-3 tw-text-center focus:tw-outline-none"},e("a",{href:"#",onClick:e=>this.onEditChildActivityClick(e,t,s),onMouseDown:t=>t.stopPropagation(),class:"tw-text-gray-400 hover:tw-text-gray-600"},e("div",{class:"tw-flex-grow"},e("span",{class:`tw-text-sm ${o}`},s.displayName))))}const i=Array.isArray(d);if(!i){return e("div",{class:`tw-relative tw-block tw-w-full tw-border-2 ${r} tw-border-solid tw-rounded-lg tw-p-3 tw-text-center focus:tw-outline-none`},e("div",{class:"tw-flex tw-space-x-2"},e("a",{href:"#",onClick:e=>this.onEditChildActivityClick(e,t,s),onMouseDown:t=>t.stopPropagation()},e("div",{class:"tw-flex-grow"},e("span",{class:`tw-text-sm ${o}`},s.displayName)))))}return e("div",{class:`tw-relative tw-block tw-w-full tw-border-2 ${r} tw-border-solid tw-rounded-lg tw-p-5 tw-text-center focus:tw-outline-none`},e("div",{class:"tw-flex tw-space-x-2"},e("a",{href:"#",onClick:e=>this.onEditChildActivityClick(e,t,s),onMouseDown:t=>t.stopPropagation()},e("div",{class:"tw-flex-grow"},e("span",{class:`tw-text-sm ${o}`},s.displayName)))))};return e("div",{class:"activity-port","data-port-name":s.name,ref:t=>this.portElements.push(t)},e("div",null,w()))};this.onEditChildActivityClick=(t,s,e)=>{t.preventDefault();this.editChildActivity.emit({parentActivityId:s.id,port:e})};this.activityType=undefined;this.activityTypeVersion=1;this.displayType=undefined;this.activityId=undefined;this.selectedPortName=undefined;this.iconRegistry=i.get(o);this.portProviderRegistry=i.get(r)}componentWillLoad(){var t;const s=this.iconRegistry;const e=this.activityType;const i=(t=this.activityTypeVersion)!==null&&t!==void 0?t:0;this.activityDescriptor=w.activityDescriptors.find((t=>t.typeName==e&&t.version==i));this.icon=s.has(e)?s.get(e):null}componentWillRender(){this.portElements=[]}render(){const t=this.activityDescriptor;const s=this.activityId;const i=this.portProviderRegistry.get(t.typeName);return e(c.Consumer,null,(({nodeMap:o})=>{var r,w,c,a,v,p;const u=o[s];const h=i.getOutboundPorts({activityDescriptor:t,activity:u});const f=h.filter((t=>t.type==l.Embedded&&t.isBrowsable!==false));const x=(v=(a=(w=(r=u===null||u===void 0?void 0:u.customProperties)===null||r===void 0?void 0:r.canStartWorkflow)!==null&&w!==void 0?w:(c=u===null||u===void 0?void 0:u.customProperties)===null||c===void 0?void 0:c.CanStartWorkflow)!==null&&a!==void 0?a:u===null||u===void 0?void 0:u.canStartWorkflow)!==null&&v!==void 0?v:false;const b=this.icon;const m=!!b;const y=x?"tw-text-white":"tw-text-gray-700";const g=(t===null||t===void 0?void 0:t.kind)==d.Trigger;const $=x?g?"tw-bg-green-400":"tw-bg-blue-400":"tw-bg-white";const k=g?"tw-bg-green-500":"tw-bg-blue-500";const j=x?g?"tw-border-green-600":"tw-border-blue-600":"tw-border-gray-300";const C=this.displayTypeIsPicker;const D=this.displayTypeIsEmbedded;const A=D?"":"tw-drop-shadow-md";const M=C?"tw-px-2 tw-py-2":"tw-px-4 tw-pt-0 tw-pb-3";let I=(p=u===null||u===void 0?void 0:u.metadata)===null||p===void 0?void 0:p.displayText;if(n(I))I=t===null||t===void 0?void 0:t.displayName;if(f.length==0||C){return e("div",null,e("div",{class:`activity-wrapper tw-border ${j} ${$} ${A} tw-rounded tw-text-white tw-overflow-hidden`},e("div",{class:"elsa-toolbar-menu-wrapper tw-flex tw-flex-row"},e("div",{class:`tw-flex tw-flex-shrink tw-items-center ${k}`},this.renderIcon(b)),e("div",{class:"tw-flex tw-items-center"},e("div",{class:C?`tw-m-2`:"tw-m-3"},e("span",{class:`${y}`},I),e("div",null,this.renderPorts(u,f)))))))}else{return e("div",null,e("div",{class:`activity-wrapper tw-border ${j} ${$} ${A} tw-rounded tw-overflow-hidden`},e("div",{class:"tw-text-white"},e("div",{class:`tw-flex tw-flex-shrink tw-items-center tw-py-3 ${m?"tw-pr-3":"tw-px-3"} ${k}`},this.renderIcon(b),e("span",null,I))),e("div",{class:"elsa-toolbar-menu-wrapper tw-flex tw-flex-col"},e("div",{class:"tw-flex tw-items-center"},e("div",{class:M},this.renderPorts(u,f))))))}}))}get displayTypeIsPicker(){return this.displayType=="picker"}get displayTypeIsEmbedded(){return this.displayType=="embedded"}onWindowClicked(t){const s=t.target;for(const t of this.portElements)if(t.contains(s))return;this.selectedPortName=null}};export{a as elsa_default_activity_template};
//# sourceMappingURL=p-698a9366.entry.js.map